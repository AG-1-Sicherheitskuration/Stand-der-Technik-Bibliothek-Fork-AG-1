{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://raw.githubusercontent.com/BSI-Bund/Stand-der-Technik-Bibliothek/refs/heads/main/Quellkataloge/Kernel/BSI-Stand-der-Technik-Kernel-catalog.json",
  "title": "BSI OSCAL Catalog Schema",
  "description": "JSON Schema for BSI OSCAL security control catalogs based on OSCAL 1.1.3 with BSI-specific extensions",
  "type": "object",
  "required": [
    "catalog"
  ],
  "properties": {
    "catalog": {
      "$ref": "#/$defs/Catalog"
    }
  },
  "$defs": {
    "Catalog": {
      "type": "object",
      "description": "Root catalog containing security controls organized in a hierarchical structure",
      "required": [
        "uuid",
        "metadata"
      ],
      "properties": {
        "uuid": {
          "type": "string",
          "format": "uuid",
          "description": "Unique identifier for the catalog"
        },
        "metadata": {
          "$ref": "#/$defs/Metadata"
        },
        "groups": {
          "type": "array",
          "description": "Top-level groups representing practices (Praktiken)",
          "items": {
            "$ref": "#/$defs/PracticeGroup"
          }
        },
        "back-matter": {
          "$ref": "#/$defs/BackMatter"
        }
      },
      "additionalProperties": false
    },
    "Metadata": {
      "type": "object",
      "description": "Catalog metadata information",
      "required": [
        "title",
        "published",
        "last-modified",
        "version",
        "oscal-version"
      ],
      "properties": {
        "title": {
          "type": "string",
          "description": "Catalog title"
        },
        "published": {
          "type": "string",
          "format": "date-time",
          "description": "Publication date in ISO 8601 format"
        },
        "last-modified": {
          "type": "string",
          "format": "date-time",
          "description": "Last modification date in ISO 8601 format"
        },
        "version": {
          "type": "string",
          "description": "Catalog version"
        },
        "oscal-version": {
          "type": "string",
          "description": "OSCAL format version used"
        },
        "remarks": {
          "type": "string",
          "description": "Additional remarks about the catalog scope"
        },
        "roles": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/Role"
          }
        },
        "parties": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/Party"
          }
        },
        "responsible-parties": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/ResponsibleParty"
          }
        }
      },
      "additionalProperties": false
    },
    "PracticeGroup": {
      "type": "object",
      "description": "Practice-level group (e.g., Governance, Architecture)",
      "required": [
        "id",
        "title"
      ],
      "properties": {
        "id": {
          "type": "string",
          "pattern": "^[A-Z]+$",
          "description": "Practice identifier (e.g., GOV, ARCH)"
        },
        "title": {
          "type": "string",
          "description": "Practice title"
        },
        "props": {
          "type": "array",
          "description": "Properties for the practice",
          "items": {
            "$ref": "#/$defs/Property"
          }
        },
        "groups": {
          "type": "array",
          "description": "Theme-level groups within this practice",
          "items": {
            "$ref": "#/$defs/ThemeGroup"
          }
        }
      },
      "additionalProperties": false
    },
    "ThemeGroup": {
      "type": "object",
      "description": "Theme-level group containing related controls",
      "required": [
        "id",
        "title"
      ],
      "properties": {
        "id": {
          "type": "string",
          "pattern": "^[A-Z]+\\.[0-9]+$",
          "description": "Theme identifier (e.g., GOV.1, ARCH.1)"
        },
        "title": {
          "type": "string",
          "description": "Theme title"
        },
        "props": {
          "type": "array",
          "description": "Properties for the theme",
          "items": {
            "$ref": "#/$defs/Property"
          }
        },
        "controls": {
          "type": "array",
          "description": "Security controls within this theme",
          "items": {
            "$ref": "#/$defs/Control"
          }
        }
      },
      "additionalProperties": false
    },
    "Control": {
      "type": "object",
      "description": "Security control (requirement) with optional enhancements",
      "required": [
        "id",
        "title"
      ],
      "properties": {
        "id": {
          "type": "string",
          "pattern": "^[A-Z]+\\.[0-9]+(\\.[0-9]+)*$",
          "description": "Control identifier (e.g., GOV.1.1, GOV.1.1.1)"
        },
        "title": {
          "type": "string",
          "description": "Control title"
        },
        "class": {
          "type": "string",
          "enum": [
            "normal-SdT",
            "erhöht"
          ],
          "description": "Sicherheitsniveau des Controls"
        },
        "params": {
          "type": "array",
          "description": "Parameters for customizable aspects of the control",
          "items": {
            "$ref": "#/$defs/Parameter"
          }
        },
        "props": {
          "type": "array",
          "description": "Control properties including BSI-specific metadata",
          "items": {
            "$ref": "#/$defs/Property"
          }
        },
        "parts": {
          "type": "array",
          "description": "Control parts (statement, objectives, guidance)",
          "items": {
            "$ref": "#/$defs/Part"
          }
        },
        "controls": {
          "type": "array",
          "description": "Sub-controls (enhancements)",
          "items": {
            "$ref": "#/$defs/Control"
          }
        },
        "links": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/Link"
          }
        }
      },
      "additionalProperties": false
    },
    "Parameter": {
      "type": "object",
      "description": "Parameterizable aspect of a control",
      "required": [
        "id"
      ],
      "properties": {
        "id": {
          "type": "string",
          "description": "Parameter identifier"
        },
        "label": {
          "type": "string",
          "description": "Parameter label"
        },
        "select": {
          "$ref": "#/$defs/Selection"
        },
        "remarks": {
          "type": "string",
          "description": "Parameter remarks"
        },
        "props": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/Property"
          }
        }
      },
      "additionalProperties": false
    },
    "Selection": {
      "type": "object",
      "description": "Selection options for a parameter",
      "required": [
        "choice"
      ],
      "properties": {
        "how-many": {
          "type": "string",
          "enum": [
            "one",
            "one-or-more"
          ],
          "description": "How many choices can be selected"
        },
        "choice": {
          "type": "array",
          "description": "Available choices",
          "items": {
            "type": "string"
          },
          "minItems": 1
        }
      },
      "additionalProperties": false
    },
    "Property": {
      "type": "object",
      "description": "Key-value property with optional namespace",
      "required": [
        "name",
        "value"
      ],
      "properties": {
        "name": {
          "type": "string",
          "enum": [
            "label",
            "alt-identifier",
            "effort_level",
            "tags",
            "target_objects",
            "documentation",
            "ergebnis",
            "präzisierung",
            "handlungsworte",
            "modalverb"
          ]
        },
        "ns": {
          "type": "string",
          "format": "uri",
          "description": "Namespace URI for the property"
        },
        "value": {
          "type": "string",
          "description": "Property value"
        },
        "remarks": {
          "type": "string",
          "description": "Additional remarks"
        }
      },
      "additionalProperties": false
    },
    "Part": {
      "type": "object",
      "description": "Part of a control (statement, objective, guidance)",
      "required": [
        "id",
        "name"
      ],
      "properties": {
        "id": {
          "type": "string",
          "description": "Part identifier"
        },
        "name": {
          "type": "string",
          "enum": [
            "statement",
            "assessment-objective",
            "objective",
            "guidance"
          ],
          "description": "Part type"
        },
        "props": {
          "type": "array",
          "description": "Part properties",
          "items": {
            "$ref": "#/$defs/Property"
          }
        },
        "prose": {
          "type": "string",
          "description": "Textual content of the part"
        },
        "parts": {
          "type": "array",
          "description": "Sub-parts for hierarchical objectives",
          "items": {
            "$ref": "#/$defs/Part"
          }
        }
      },
      "additionalProperties": false
    },
    "BackMatter": {
      "type": "object",
      "description": "Back matter containing resources and references",
      "properties": {
        "resources": {
          "type": "array",
          "description": "Referenced resources",
          "items": {
            "$ref": "#/$defs/Resource"
          }
        }
      },
      "additionalProperties": false
    },
    "Resource": {
      "type": "object",
      "description": "Referenced resource",
      "required": [
        "uuid",
        "title"
      ],
      "properties": {
        "uuid": {
          "type": "string",
          "format": "uuid",
          "description": "Resource identifier"
        },
        "title": {
          "type": "string",
          "description": "Resource title"
        },
        "description": {
          "type": "string",
          "description": "Resource description"
        },
        "rlinks": {
          "type": "array",
          "description": "Resource links",
          "items": {
            "$ref": "#/$defs/ResourceLink"
          }
        }
      },
      "additionalProperties": false
    },
    "ResourceLink": {
      "type": "object",
      "description": "Link to a resource",
      "required": [
        "href"
      ],
      "properties": {
        "href": {
          "type": "string",
          "format": "uri",
          "description": "Resource URL"
        }
      },
      "additionalProperties": false
    },
    "Link": {
      "type": "object",
      "required": [
        "href"
      ],
      "properties": {
        "rel": {
          "type": "string",
          "enum": [
            "required",
            "related",
            "reference",
            "incorporated-into",
            "moved-to"
          ]
        },
        "href": {
          "type": "string"
        },
        "text": {
          "type": "string"
        },
        "resource-fragment": {
          "type": "string"
        }
      },
      "additionalProperties": false
    },
    "Role": {
      "type": "object",
      "required": [
        "id"
      ],
      "properties": {
        "id": {
          "type": "string"
        },
        "title": {
          "type": "string"
        }
      },
      "additionalProperties": false
    },
    "Party": {
      "type": "object",
      "required": [
        "uuid",
        "type",
        "name"
      ],
      "properties": {
        "uuid": {
          "type": "string"
        },
        "type": {
          "type": "string",
          "enum": [
            "organization",
            "person"
          ]
        },
        "name": {
          "type": "string"
        },
        "email-addresses": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "addresses": {
          "type": "array",
          "items": {
            "type": "object"
          }
        },
        "short-name": {
          "type": "string"
        }
      },
      "additionalProperties": true
    },
    "ResponsibleParty": {
      "type": "object",
      "required": [
        "role-id",
        "party-uuids"
      ],
      "properties": {
        "role-id": {
          "type": "string"
        },
        "party-uuids": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      },
      "additionalProperties": false
    }
  }
}